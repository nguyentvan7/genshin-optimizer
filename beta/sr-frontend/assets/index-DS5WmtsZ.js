import{g as Te,a as We,c as G,j as b,s as q,P as Ge,b as V,d as pe,l as he,_ as N,r as f,u as He,e as Ue,I as se,f as Fe,h as qe,i as H,k as U,m as T,n as Ee,o as e,S as F,p as c,B as S,q as Ve,C as Qe,T as w,t as Ze,v as Re,w as W,N as fe,x as me,y as A,z as D,A as Q,D as Je,E as Xe,F as Ye,G as et,H as ke,J as tt,K as st,L as rt,M as ge,O as at,Q as lt,R as Ie,U as ot,V as Me,W as nt,X as it,Y as ct,Z as dt,$ as ut,a0 as pt,a1 as ht,a2 as ft}from"./index-3npgABpY.js";import{T as mt}from"./UploadCard--46alwX2.js";import{u as $e,C as gt}from"./useForceUpdate-BAHK-gqH.js";import{S as Z,a as vt,r as yt,b as J,D as we,M as X,T as xt}from"./StatDisplay-BCrhFHeb.js";import{u as ve,R as bt,S as Y,a as St,b as Ct,c as Rt,d as kt,e as It}from"./RelicSetAutocomplete-Df2AaJ0Q.js";import{L as Mt,a as $t,b as wt,E as _t,d as ee}from"./Add-Dij8vWXI.js";import{C as Kt,L as _e,D as At,a as Ke,b as jt,d as zt}from"./BusinessCenter-Kd6o2Gzk.js";import{C as re,G as $}from"./Grid-V0UDWjI0.js";import{u as Dt,a as Lt}from"./useInfScroll-CR1tmDs8.js";function Pt(s){return We("MuiAlert",s)}const Nt=Te("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),ye=Nt,Ot=G(b.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Bt=G(b.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Tt=G(b.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Wt=G(b.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),Gt=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],Ht=s=>{const{variant:l,color:d,severity:r,classes:m}=s,i={root:["root",`color${V(d||r)}`,`${l}${V(d||r)}`,`${l}`],icon:["icon"],message:["message"],action:["action"]};return qe(i,Pt,m)},Ut=q(Ge,{name:"MuiAlert",slot:"Root",overridesResolver:(s,l)=>{const{ownerState:d}=s;return[l.root,l[d.variant],l[`${d.variant}${V(d.color||d.severity)}`]]}})(({theme:s})=>{const l=s.palette.mode==="light"?pe:he,d=s.palette.mode==="light"?he:pe;return N({},s.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(s.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:s.vars?s.vars.palette.Alert[`${r}Color`]:l(s.palette[r].light,.6),backgroundColor:s.vars?s.vars.palette.Alert[`${r}StandardBg`]:d(s.palette[r].light,.9),[`& .${ye.icon}`]:s.vars?{color:s.vars.palette.Alert[`${r}IconColor`]}:{color:s.palette[r].main}}})),...Object.entries(s.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:s.vars?s.vars.palette.Alert[`${r}Color`]:l(s.palette[r].light,.6),border:`1px solid ${(s.vars||s).palette[r].light}`,[`& .${ye.icon}`]:s.vars?{color:s.vars.palette.Alert[`${r}IconColor`]}:{color:s.palette[r].main}}})),...Object.entries(s.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:N({fontWeight:s.typography.fontWeightMedium},s.vars?{color:s.vars.palette.Alert[`${r}FilledColor`],backgroundColor:s.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:s.palette.mode==="dark"?s.palette[r].dark:s.palette[r].main,color:s.palette.getContrastText(s.palette[r].main)})}))]})}),Ft=q("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(s,l)=>l.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),qt=q("div",{name:"MuiAlert",slot:"Message",overridesResolver:(s,l)=>l.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),xe=q("div",{name:"MuiAlert",slot:"Action",overridesResolver:(s,l)=>l.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),be={success:b.jsx(Ot,{fontSize:"inherit"}),warning:b.jsx(Bt,{fontSize:"inherit"}),error:b.jsx(Tt,{fontSize:"inherit"}),info:b.jsx(Wt,{fontSize:"inherit"})},Et=f.forwardRef(function(l,d){const r=He({props:l,name:"MuiAlert"}),{action:m,children:i,className:o,closeText:u="Close",color:g,components:k={},componentsProps:_={},icon:v,iconMapping:t=be,onClose:y,role:p="alert",severity:x="success",slotProps:n={},slots:h={},variant:L="standard"}=r,j=Ue(r,Gt),C=N({},r,{color:g,severity:x,variant:L,colorSeverity:g||x}),R=Ht(C),M={slots:N({closeButton:k.CloseButton,closeIcon:k.CloseIcon},h),slotProps:N({},_,n)},[K,z]=ve("closeButton",{elementType:se,externalForwardedProps:M,ownerState:C}),[E,O]=ve("closeIcon",{elementType:Kt,externalForwardedProps:M,ownerState:C});return b.jsxs(Ut,N({role:p,elevation:0,ownerState:C,className:Fe(R.root,o),ref:d},j,{children:[v!==!1?b.jsx(Ft,{ownerState:C,className:R.icon,children:v||t[x]||be[x]}):null,b.jsx(qt,{ownerState:C,className:R.message,children:i}),m!=null?b.jsx(xe,{ownerState:C,className:R.action,children:m}):null,m==null&&y?b.jsx(xe,{ownerState:C,className:R.action,children:b.jsx(K,N({size:"small","aria-label":u,title:u,color:"inherit",onClick:y},z,{children:b.jsx(E,N({fontSize:"small"},O))}))}):null]}))}),Vt=Et;var ae={},Qt=U;Object.defineProperty(ae,"__esModule",{value:!0});var Ae=ae.default=void 0,Zt=Qt(H()),Jt=b,Xt=(0,Zt.default)((0,Jt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");Ae=ae.default=Xt;const Yt=G(b.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"DoNotDisturb"),es=s=>"roll"+(Math.floor(Math.max(s,0)/3)+1);function te({relic:s,onClick:l,onEdit:d,onDelete:r,onLockToggle:m,setLocation:i,mainStatAssumptionLevel:o=0,extraButtons:u,excluded:g=!1}){const{t:k}=T("relic"),{t:_}=T(["relics_gen","statKey_gen"]),{lock:v,slotKey:t,setKey:y,rarity:p,level:x,mainStatKey:n,substats:h,location:L=""}=s,j=Math.max(Math.min(o,p*3),x),C=Ee.find(R=>n.startsWith(R));return e(f.Suspense,{fallback:e(F,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:350}}),children:c(D,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column"},children:[c(S,{className:`grad-${p}star`,sx:{position:"relative",width:"100%"},children:[!l&&!!m&&e(se,{color:"primary",onClick:m,sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:v?e(Mt,{}):e($t,{})}),g&&e(Ve,{color:"primary",fontSize:"large",sx:{position:"absolute",right:3,bottom:3,zIndex:2},children:e(Yt,{})}),c(S,{sx:{pt:2,px:2,position:"relative",zIndex:1},children:[c(S,{component:"div",sx:{display:"flex",alignItems:"center",gap:.4,mb:1},children:[e(Qe,{size:"small",label:e("strong",{children:`+${x}`}),color:es(x)}),e(w,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1.5},children:e("strong",{children:y&&e(bt,{setKey:y})||"Relic Set"})})]}),c(w,{color:"text.secondary",variant:"body2",sx:{display:"flex",gap:.5,alignItems:"center"},children:[e(Y,{iconProps:{fontSize:"inherit"},slotKey:t}),_(`relics_gen:${t}`)]}),c(w,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[e(Z,{statKey:n,iconProps:{sx:{color:`${C}.main`}}}),e("span",{children:_(`statKey_gen:${n}`)})]}),e(w,{variant:"h5",children:e("strong",{children:c(Ze,{color:j!==x?"warning":void 0,children:[Re(p,n,x),W(n)]})})}),e(vt,{stars:p,colored:!0})]}),e(S,{sx:{height:"100%",position:"absolute",right:0,top:0},children:e(S,{component:fe?fe:"img",alt:"Relic Piece Image",src:yt(y,t),sx:{width:"auto",height:"90%",float:"right",marginBottom:"5%",marginTop:"5%",marginRight:"10%"}})})]}),c(re,{sx:{flexGrow:1,display:"flex",flexDirection:"column",pt:1,pb:"0!important",width:"100%"},children:[h.map(R=>R.key&&e(ts,{substat:R},R.key)),e(S,{flexGrow:1}),e(w,{color:"success.main"})]}),c(S,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(S,{sx:{flexGrow:1},children:i?e(_e,{locKey:L,setLocKey:i}):e(wt,{location:L})}),c(S,{display:"flex",gap:1,alignItems:"stretch",height:"100%",sx:{"& .MuiButton-root":{minWidth:0,height:"100%"}},children:[!!d&&e(me,{title:e(w,{children:k("edit")}),placement:"top",arrow:!0,children:e(A,{color:"info",size:"small",onClick:d,children:e(_t,{})})}),!!r&&e(me,{title:v?k("cantDeleteLock"):"",placement:"top",children:e("span",{children:e(A,{color:"error",size:"small",onClick:r,disabled:v,sx:{top:"1px"},children:e(At,{})})})}),u]})]})]})})}function ts({substat:s}){const{key:l,value:d}=s;if(!d||!l)return null;const r=Q(d,l).toFixed(Je(l));return c(w,{sx:{display:"flex",alignItems:"center"},children:[e(J,{statKey:l}),c("span",{children:["+",r,W(l)]})]})}var le={},ss=U;Object.defineProperty(le,"__esModule",{value:!0});var je=le.default=void 0,rs=ss(H()),as=b,ls=(0,rs.default)((0,as.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");je=le.default=ls;var oe={},os=U;Object.defineProperty(oe,"__esModule",{value:!0});var ze=oe.default=void 0,ns=os(H()),is=b,cs=(0,ns.default)((0,is.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");ze=oe.default=cs;var ne={},ds=U;Object.defineProperty(ne,"__esModule",{value:!0});var De=ne.default=void 0,us=ds(H()),ps=b,hs=(0,us.default)((0,ps.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");De=ne.default=hs;var ie={},fs=U;Object.defineProperty(ie,"__esModule",{value:!0});var Le=ie.default=void 0,ms=fs(H()),gs=b,vs=(0,ms.default)((0,gs.jsx)("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update");Le=ie.default=vs;function ys(s,l){const r=(()=>{switch(l.type){case"reset":return;case"substat":{const{index:m,substat:i}=l,o=[...s.substats],u=i.key?o.findIndex(g=>g.key===i.key):-1;if(u===-1||u===m)o[m]={...i};else{const g=o[m];o[m]={...o[u]},o[u]={...g}}return{...s,substats:o}}case"overwrite":return l.relic;case"update":return{...s,...l.relic}}})();return r&&Xe(r,!0,!1)}function xs({index:s,relic:l,setSubstat:d}){const{t:r}=T("relic"),{mainStatKey:m="",rarity:i=5}=l??{},{key:o="",value:u=0,rolls:g=[],efficiency:k=0}=(l==null?void 0:l.substats[s])??{},_=g.length;let v="",t=[],y=0;if(l){const n=l.rarity,{numUpgrades:h,high:L}=ot[n];y=h+L-3-_,t=o?Ye(o,n):[]}const p=7-t.length;y<0&&(v=v||r("editor.substat.error.noOverRoll",{value:y+_}));const x=f.useMemo(()=>o?[{value:0},...et(i,o).map(n=>({value:n}))]:[{value:0}],[o,i]);return c(D,{bgt:"light",children:[e(S,{sx:{display:"flex"},children:c(ke,{size:"small",sx:{width:"100%",display:"flex"},children:[c(we,{startIcon:o?e(Z,{statKey:o}):void 0,title:o?e(J,{statKey:o,showPercent:!0,disableIcon:!0}):r("editor.substat.substatFormat",{value:s+1}),disabled:!l,color:o?"success":"primary",sx:{whiteSpace:"nowrap"},children:[o&&e(X,{onClick:()=>d(s,{key:"",value:0}),children:r("editor.substat.noSubstat")}),tt.filter(n=>m!==n).map(n=>c(X,{selected:o===n,disabled:o===n,onClick:()=>d(s,{key:n,value:0}),children:[e(Ke,{children:e(Z,{statKey:n})}),e(jt,{children:e(J,{statKey:n,showPercent:!0,disableIcon:!0})})]},n))]}),e(st,{sx:{flexBasis:30,flexGrow:1},children:e(rt,{float:W(o)==="%",placeholder:r("editor.substat.selectSub"),value:o?ge(Q(u,o),o):void 0,onChange:n=>{let h=n??0;W(o)==="%"&&(h=h/100),d(s,{key:o,value:h})},disabled:!o,error:!!v,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!t.length&&e(at,{children:r("editor.substat.nextRolls")})]})}),e(S,{px:2,children:e(bs,{value:ge(Q(u,o),o),marks:x,setValue:n=>{let h=n??0;W(o)==="%"&&(h=h/100),d(s,{key:o,value:h})},disabled:!o})}),e(S,{sx:{px:1,pb:1},children:v?e(lt,{color:"error",children:r("ui:error")}):c($,{container:!0,children:[e($,{item:!0,flexGrow:1,children:!!g.length&&[...g].sort().map((n,h)=>e(w,{component:"span",color:`roll${Ie(p+t.indexOf(n),1,6)}.main`,sx:{ml:1},children:n},`${h}.${n}`))}),e($,{item:!0,xs:"auto",flexShrink:1,children:e(w,{children:c(mt,{t:r,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",k]})})})]})})]})}function bs({value:s,setValue:l,marks:d,disabled:r=!1}){var o,u;const[m,i]=f.useState(s);return f.useEffect(()=>i(s),[s]),e(St,{value:m,step:.1,disabled:r,min:((o=d[1])==null?void 0:o.value)??0,max:((u=d[d.length-1])==null?void 0:u.value)??0,onChange:(g,k)=>i(k),onChangeCommitted:(g,k)=>l(k),valueLabelDisplay:"auto"})}const Se={rarity:[5,4,3,2],setEffects:{}};function Ss({relicIdToEdit:s="new",cancelEdit:l,fixedSlotKey:d,allowEmpty:r=!1,disableSet:m=!1}){const{t:i}=T("relic"),{t:o}=T(["relics_gen","statKey_gen"]),{database:u}=Me(),[g,k]=$e();f.useEffect(()=>u.relics.followAny(k),[u,k]);const[_,v]=f.useState(!1);f.useEffect(()=>{s==="new"&&(v(!0),y({type:"reset"}));const a=s&&g&&u.relics.get(s);a&&(v(!0),y({type:"overwrite",relic:nt(a)}))},[s,u,g]);const[t,y]=f.useReducer(ys,void 0),{relic:p,errors:x}=f.useMemo(()=>t?it(t,s):{relic:void 0,errors:[]},[t,s]),{prev:n,prevEditType:h}=f.useMemo(()=>{const a=g&&s&&u.relics.get(s);if(a)return{prev:a,prevEditType:"edit"};if(t===void 0)return{prev:void 0,prevEditType:""};const{duplicated:I,upgraded:P}=g&&u.relics.findDups(t);return{prev:I[0]??P[0],prevEditType:I.length!==0?"duplicate":"upgrade"}},[t,s,u,g]),L=!["new",""].includes(s)&&!!(t!=null&&t.location)||!!d||!!s&&s!=="new",{rarity:j=5,level:C=0}=t??{},R=f.useMemo(()=>(t==null?void 0:t.slotKey)??d??"head",[d,t]),M=t?Se:void 0,K=f.useCallback(a=>{const I=a.setKey?Se:M;function P(B,ue,Be){return B&&ue.includes(B)?B:Be??ue[0]}a.setKey&&(a.rarity=P(t==null?void 0:t.rarity,I.rarity,Math.max(...I.rarity)),a.slotKey=P(t==null?void 0:t.slotKey,["head","hands"])),a.rarity&&(a.level=(t==null?void 0:t.level)??0),a.level&&(a.level=Ie(a.level,0,3*(a.rarity??t.rarity))),a.slotKey&&(a.mainStatKey=P(t==null?void 0:t.mainStatKey,ct[a.slotKey])),a.mainStatKey&&(a.substats=[0,1,2,3].map(B=>t&&t.substats[B].key!==a.mainStatKey?t.substats[B]:{key:"",value:0})),y({type:"update",relic:a})},[t,M,y]),z=f.useCallback(()=>{l==null||l(),y({type:"reset"})},[l,y]),E=f.useCallback((a,I)=>y({type:"substat",index:a,substat:I}),[]),O=!x.length,ce=f.useCallback(a=>{if(!s&&t&&!window.confirm(i("editor.clearPrompt"))){a==null||a.preventDefault();return}v(!1),z()},[i,s,t,v,z]),Pe=dt(),Ne=ut(Pe.breakpoints.up("md")),de=s!=="new"&&s||(n==null?void 0:n.id),Oe=()=>window.confirm(i("editor.clearPrompt"));return e(f.Suspense,{fallback:!1,children:e(pt,{open:_,onClose:ce,children:c(D,{bgt:"dark",children:[e(gt,{title:"Relic Editor",action:e(se,{onClick:ce,children:e(zt,{})})}),c(re,{sx:{display:"flex",flexDirection:"column",gap:1},children:[c($,{container:!0,spacing:1,columns:{xs:1,md:2},children:[c($,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[c(S,{sx:{display:"flex",gap:1},children:[e(Ct,{disabled:m,size:"small",relicSetKey:(t==null?void 0:t.setKey)??"",setRelicSetKey:a=>K({setKey:a}),sx:{flexGrow:1},label:t!=null&&t.setKey?"":i("editor.unknownSetName")}),e(Rt,{rarity:t?j:void 0,onRarityChange:a=>K({rarity:a}),filter:a=>{var I,P;return!!((P=(I=M==null?void 0:M.rarity)==null?void 0:I.includes)!=null&&P.call(I,a))},disabled:!M})]}),c(S,{component:"div",display:"flex",children:[e(xt,{label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:C,disabled:!M,onChange:a=>{const I=parseInt(a.target.value)||0;K({level:I})}}),c(ke,{children:[e(A,{onClick:()=>K({level:C-1}),disabled:!M||C===0,children:"-"}),j?[...Array(j+1).keys()].map(a=>3*a).map(a=>e(A,{onClick:()=>K({level:a}),disabled:!M||C===a,children:a},a)):null,e(A,{onClick:()=>K({level:C+1}),disabled:!M||C===j*3,children:"+"})]})]}),c(S,{component:"div",display:"flex",children:[e(we,{startIcon:t!=null&&t.slotKey?e(Y,{slotKey:t.slotKey}):void 0,title:t?o(t.slotKey):i("slot"),value:R,disabled:L||!M,color:t?"success":"primary",children:ht.map(a=>c(X,{selected:R===a,disabled:R===a,onClick:()=>K({slotKey:a}),children:[e(Ke,{children:e(Y,{slotKey:a})}),o(a)]},a))}),e(D,{bgt:"light",sx:{p:1,ml:1,flexGrow:1},children:e(f.Suspense,{fallback:e(F,{width:"60%"}),children:e(w,{color:"text.secondary",children:o(`relics_gen:${R}`)})})})]}),c(S,{component:"div",display:"flex",gap:1,children:[e(kt,{slotKey:R,statKey:t==null?void 0:t.mainStatKey,setStatKey:a=>K({mainStatKey:a}),defText:i("mainStat"),dropdownButtonProps:{disabled:!M,color:t?"success":"primary"}}),e(D,{bgt:"light",sx:{p:1,flexGrow:1},children:e(w,{color:"text.secondary",children:t?Re(j,t.mainStatKey,C):i("mainStat")})}),e(A,{onClick:()=>K({lock:!(t!=null&&t.lock)}),color:t!=null&&t.lock?"success":"primary",disabled:!t,children:t!=null&&t.lock?e(ze,{}):e(De,{})})]}),e(_e,{locKey:(p==null?void 0:p.location)??"",setLocKey:a=>K({location:a})})]}),e($,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[0,1,2,3].map(a=>e(xs,{index:a,relic:p,setSubstat:E},a))})]}),n&&c($,{container:!0,sx:{justifyContent:"space-around"},spacing:1,children:[e($,{item:!0,xs:12,md:5.5,lg:4,children:c(D,{bgt:"light",children:[e(w,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:i(h!=="edit"?h==="duplicate"?"editor.dupeRelic":"editor.updateRelic":"editor.beforeEdit")}),e(te,{relic:n})]})}),Ne&&e($,{item:!0,md:1,display:"flex",alignItems:"center",justifyContent:"center",children:e(D,{bgt:"light",sx:{display:"flex"},children:e(je,{sx:{fontSize:40}})})}),e($,{item:!0,xs:12,md:5.5,lg:4,children:c(D,{bgt:"light",children:[e(w,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:i("editor.preview")}),p&&e(te,{relic:p})]})})]}),!O&&e(Vt,{variant:"filled",severity:"error",children:x.map((a,I)=>e("div",{children:a},I))}),c(S,{display:"flex",gap:2,children:[h==="edit"?e(A,{startIcon:e(ee,{}),onClick:()=>{t&&u.relics.set(n.id,t),r||(v(!1),l()),z()},disabled:!t||!O,color:"primary",children:i("editor.btnSave")}):e(A,{startIcon:e(ee,{}),onClick:()=>{u.relics.new(t),r||(v(!1),l()),z()},disabled:!t||!O,color:h==="duplicate"?"warning":"primary",children:i("editor.btnAdd")}),r&&e(A,{startIcon:e(Ae,{}),disabled:!t,onClick:()=>{Oe()&&z()},color:"error",children:i("editor.btnClear")}),n&&h!=="edit"&&e(A,{startIcon:e(Le,{}),onClick:()=>{t&&u.relics.set(n.id,t),z(),r||v(!1)},disabled:!t||!O,color:"success",children:i("editor.btnUpdate")}),!!de&&e(A,{startIcon:e(It,{}),onClick:()=>{window.confirm(i("editor.confirmDelete"))&&(u.relics.remove(de),z(),r||v(!1))},disabled:!t||!O,color:"error",children:i("editor.delete")})]})]})]})})})}const Ce={xs:1,sm:2,md:3,lg:3,xl:4},Cs={xs:10,sm:12,md:24,lg:24,xl:24};function Rs({onAdd:s,onEdit:l}){const{t:d}=T("relic"),{database:r}=Me(),[m,i]=$e();f.useEffect(()=>r.relics.followAny(i),[r,i]);const{relicIds:o,totalRelicsNum:u}=f.useMemo(()=>{const p=r.relics.values,x=p.length,n=p.map(h=>h.id);return m&&{relicIds:n,totalRelicsNum:x}},[r,m]),g=Dt(),k=o.length!==u?`${o.length}/${u}`:u,{numShow:_,setTriggerElement:v}=Lt(Cs[g],o.length),t=f.useMemo(()=>o.slice(0,_),[o,_]),y={numShowing:t.length,totalShowing:k};return c(ft,{children:[e(D,{bgt:"dark",children:e(re,{children:e(S,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:c(w,{color:"text.secondary",children:["Showing ",e("b",{children:y.numShowing})," out of"," ",y.totalShowing," Items"]})})})}),e($,{container:!0,columns:Ce,spacing:1,children:e($,{item:!0,xs:!0,children:e(A,{fullWidth:!0,onClick:s,color:"info",startIcon:e(ee,{}),children:d("addNew")})})}),c(f.Suspense,{fallback:e(F,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[e($,{container:!0,columns:Ce,spacing:1,children:t.map(p=>e($,{item:!0,xs:1,children:e(te,{relic:r.relics.get(p),onEdit:()=>l==null?void 0:l(p),onDelete:()=>r.relics.remove(p),setLocation:x=>r.relics.set(p,{location:x}),onLockToggle:()=>r.relics.set(p,({lock:x})=>({lock:!x}))})},p))}),o.length!==t.length&&e(F,{ref:p=>{p&&v(p)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}function zs(){const[s,l]=f.useState("");return c(S,{display:"flex",flexDirection:"column",gap:1,my:1,children:[e(Ss,{relicIdToEdit:s,cancelEdit:()=>l(""),allowEmpty:!0}),e(Rs,{onAdd:()=>l("new"),onEdit:l})]})}export{zs as default};
