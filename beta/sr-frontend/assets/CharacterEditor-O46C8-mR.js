import{bE as re,bF as ie,bG as N,bH as $,bI as _,bJ as le,bK as ce,bL as ue,r as m,bM as de,bN as pe,j as P,f as me,bO as fe,bP as he,ab as be,bQ as A,s as ge,u as ve,V as D,a3 as v,o as s,b4 as Ce,bR as xe,p as c,z as V,N as O,B as C,T as p,bS as ke,t as Se,A as F,a5 as ye,D as _e,w as z,i as G,k as H,S as je,a0 as Be,bT as Pe,a9 as b,y as R}from"./index-BopMuR17.js";import{M as q,D as U,c as h,C as W,a as De,E as Ee,b as Ie,d as J,T as L,S as Me}from"./StatDisplay-CRRt0E0L.js";import{u as Te,s as $e,c as Ae,P as Oe}from"./PathIcon-Cf2OkzON.js";import{C as Re,a as Le,b as x}from"./UploadCard-COdDempx.js";import{C as we}from"./CardActionArea-qsEdcHJP.js";import{C as Q,G as d}from"./Grid-Bj35p5q-.js";const Ne=["component","direction","spacing","divider","children","className","useFlexGap"],Ve=re(),Fe=ie("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function ze(t){return fe({props:t,name:"MuiStack",defaultTheme:Ve})}function Ge(t,e){const a=m.Children.toArray(t).filter(Boolean);return a.reduce((n,o,r)=>(n.push(o),r<a.length-1&&n.push(m.cloneElement(e,{key:`separator-${r}`})),n),[])}const He=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],qe=({ownerState:t,theme:e})=>{let a=N({display:"flex",flexDirection:"column"},$({theme:e},_({values:t.direction,breakpoints:e.breakpoints.values}),n=>({flexDirection:n})));if(t.spacing){const n=le(e),o=Object.keys(e.breakpoints.values).reduce((l,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(l[u]=!0),l),{}),r=_({values:t.direction,base:o}),i=_({values:t.spacing,base:o});typeof r=="object"&&Object.keys(r).forEach((l,u,k)=>{if(!r[l]){const y=u>0?r[k[u-1]]:"column";r[l]=y}}),a=ce(a,$({theme:e},i,(l,u)=>t.useFlexGap?{gap:A(n,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${He(u?r[u]:t.direction)}`]:A(n,l)}}))}return a=ue(e.breakpoints,a),a};function Ue(t={}){const{createStyledComponent:e=Fe,useThemeProps:a=ze,componentName:n="MuiStack"}=t,o=()=>he({root:["root"]},l=>be(n,l),{}),r=e(qe);return m.forwardRef(function(l,u){const k=a(l),S=de(k),{component:y="div",direction:K="column",spacing:ee=0,divider:M,children:T,className:te,useFlexGap:se=!1}=S,ne=pe(S,Ne),oe={direction:K,spacing:ee,useFlexGap:se},ae=o();return P.jsx(r,N({as:y,ownerState:oe,ref:u,className:me(ae.root,te)},ne,{children:M?Ge(T,M):T}))})}const We=Ue({createStyledComponent:ge("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>ve({props:t,name:"MuiStack"})}),X=We;function Y(t){const{database:e}=D();return Te(e.chars,t)}function Z(t){return v.char[t]}function ft(t,e,a,n=0){switch(e){case"eidolon":return Object.fromEntries(v.char[t].rankMap[a].params.map((o,r)=>[r+1,o]));case"basic":case"skill":case"ult":case"talent":case"technique":return Object.fromEntries(v.char[t].skillTree[e].skillParamList[n].map((o,r)=>[r+1,o[a]]));case"bonusAbility1":case"bonusAbility2":case"bonusAbility3":return Object.fromEntries(v.char[t].skillTree[e].skillParamList[n][a].map((o,r)=>[r+1,o]))}}function Je(t,e){const n=Qe(t,e).levels;if(!(n!=null&&n.length))throw new Error(`No stat boost levels found for character ${t}`);const o=Object.entries(n[0].stats??{});if(!o.length)throw new Error(`No stats found in stat boost for character ${t}`);const[r,i]=o[0];return{statKey:r,value:i}}function Qe(t,e){const{skillTree:a}=Z(t);return a[`statBoost${e}`]}function g({characterKey:t,abilityKey:e,dropDownButtonProps:a={}}){const n=Y(t),{database:o}=D(),r=e.charAt(0).toUpperCase()+e.slice(1);return s(U,{title:`${r} Lv. ${(n==null?void 0:n[e])??1}`,disabled:!n,...a,children:!!t&&Ce(1,xe[e][(n==null?void 0:n.ascension)??0]).map(i=>c(q,{selected:(n==null?void 0:n[e])===i,disabled:(n==null?void 0:n[e])===i,onClick:()=>o.chars.set(t,{[e]:i}),children:[r," Lv. ",i]},`${e}_${i}`))})}function Xe(){const t=m.useContext(Re),e=m.useContext(Le);return m.useMemo(()=>t==null?void 0:t.withTag(e),[t,e])}const Ye=["hp","atk","def","spd","crit_","crit_dmg_","brEffect_","heal_","enerRegen_","eff_","eff_res_"];function ht({character:t,onClick:e}){const a=Xe()??$e(Ae(t));return s(X,{children:c(V,{children:[e?s(we,{onClick:e,children:s(w,{character:t})}):s(w,{character:t}),s(x,{}),s(Q,{children:Ye.map(n=>s(Ze,{calc:a,statKey:n,characterKey:t.key},n))})]})})}function w({character:t}){const{key:e,eidolon:a,level:n,ascension:o}=t,r=J(e),{damageType:i,path:f,rarity:l}=Z(e);return c(C,{sx:{display:"flex"},children:[s(C,{component:O?O:"img",alt:"Character Icon",src:h(r,"icon"),sx:{maxHeight:"10em",width:"auto"}}),c(C,{sx:{px:2,pt:1},children:[s(p,{variant:"h5",children:s(W,{genderedKey:r})}),s(p,{children:s(De,{stars:l,inline:!0})}),c(p,{children:["Lv.",ke(n,o)," Eidolon: ",a]}),s(Oe,{pathKey:f}),s(Se,{color:i,children:s(Ee,{ele:i})})]})]})}function Ze({characterKey:t,calc:e,statKey:a}){return c(p,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[s(Ie,{statKey:a}),c("span",{children:[F(e.withTag({src:t,dst:t}).compute(ye.final[a]).val,a).toFixed(_e(a)),z(a)]})]})}var E={},Ke=H;Object.defineProperty(E,"__esModule",{value:!0});var j=E.default=void 0,et=Ke(G()),tt=P,st=(0,et.default)((0,tt.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");j=E.default=st;var I={},nt=H;Object.defineProperty(I,"__esModule",{value:!0});var B=I.default=void 0,ot=nt(G()),at=P,rt=(0,ot.default)((0,at.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");B=I.default=rt;function bt({characterKey:t,onClose:e}){return s(Be,{open:!!t,onClose:e,children:s(m.Suspense,{fallback:s(je,{variant:"rectangular",width:"100%",height:1e3}),children:t&&s(it,{characterKey:t})})})}function it({characterKey:t}){const e=Y(t),a=J(t),{database:n}=D();return s(V,{children:c(Q,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s(p,{variant:"h3",children:s(W,{genderedKey:a})}),s(L,{type:"number",label:"Level",variant:"outlined",inputProps:{min:1,max:90},value:(e==null?void 0:e.level)||0,onChange:o=>n.chars.set(t,{level:parseInt(o.target.value)}),disabled:!e}),s(L,{type:"number",label:"Ascension",variant:"outlined",inputProps:{min:0,max:6},value:(e==null?void 0:e.ascension)||0,onChange:o=>n.chars.set(t,{ascension:parseInt(o.target.value)}),disabled:!e}),s(U,{title:`Eidolon Lv. ${(e==null?void 0:e.eidolon)??0}`,fullWidth:!1,disabled:!e,children:Pe.map(o=>c(q,{selected:(e==null?void 0:e.eidolon)===o,disabled:(e==null?void 0:e.eidolon)===o,onClick:()=>n.chars.set(t,{eidolon:o}),children:["Eidolon Lv. ",o]},o))}),c(X,{spacing:1,children:[s(p,{variant:"h6",children:"Abilites"}),s(x,{}),c(d,{container:!0,gap:1,children:[s(d,{item:!0,children:s(g,{characterKey:t,abilityKey:"basic",dropDownButtonProps:{startIcon:s(b,{size:1.5,sideMargin:!0,src:h(a,"basic_0")})}})}),s(d,{item:!0,children:s(g,{characterKey:t,abilityKey:"skill",dropDownButtonProps:{startIcon:s(b,{size:1.5,sideMargin:!0,src:h(a,"skill_0")})}})}),s(d,{item:!0,children:s(g,{characterKey:t,abilityKey:"ult",dropDownButtonProps:{startIcon:s(b,{size:1.5,sideMargin:!0,src:h(a,"ult_0")})}})}),s(d,{item:!0,children:s(g,{characterKey:t,abilityKey:"talent",dropDownButtonProps:{startIcon:s(b,{size:1.5,sideMargin:!0,src:h(a,"talent_0")})}})})]}),s(p,{variant:"h6",children:"Bonus Abilities"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.bonusAbilities)??{}).map(([o,r])=>s(d,{item:!0,children:s(R,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{bonusAbilities:{...e==null?void 0:e.bonusAbilities,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:s(b,{size:2,src:h(a,`bonusAbility${o}`),sideMargin:!0})})},o))}),s(p,{variant:"h6",children:"Stat Boosts"}),s(x,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.statBoosts)??{}).map(([o,r])=>{const{statKey:i,value:f}=Je(t,o);return s(d,{item:!0,children:c(R,{color:r?"success":"primary",onClick:()=>{n.chars.set(t,{statBoosts:{...e==null?void 0:e.statBoosts,[o]:!r}})},startIcon:r?s(j,{}):s(B,{}),children:[s(Me,{statKey:i,iconProps:{sx:{ml:-1,mr:.5}}}),c(C,{children:[F(f,i),z(i)]})]})},o)})})]})]})})}export{bt as C,X as S,ht as a,B as b,Ue as c,j as d,Z as e,Xe as f,ft as g,Y as u};
