"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.normalizeSchema = void 0;
const devkit_1 = require("@nx/devkit");
function normalizeSchema(host, schema) {
    var _a;
    const { layoutDirectory, projectDirectory } = (0, devkit_1.extractLayoutDirectory)(schema.directory);
    const { libsDir: defaultLibsDir } = (0, devkit_1.getWorkspaceLayout)(host);
    const libsDir = layoutDirectory !== null && layoutDirectory !== void 0 ? layoutDirectory : defaultLibsDir;
    const name = (0, devkit_1.names)(schema.name).fileName;
    const fullProjectDirectory = projectDirectory
        ? `${(0, devkit_1.names)(projectDirectory).fileName}/${name}`
        : name;
    const projectName = fullProjectDirectory.replace(new RegExp('/', 'g'), '-');
    const projectRoot = (0, devkit_1.joinPathFragments)(libsDir, fullProjectDirectory);
    return Object.assign(Object.assign({}, schema), { bundler: (_a = schema.compiler) !== null && _a !== void 0 ? _a : 'tsc', libsDir,
        projectName,
        projectRoot,
        name, projectDirectory: fullProjectDirectory });
}
exports.normalizeSchema = normalizeSchema;
